# -*- cofing: utf-8 -*-
'''
Stage: Club room
'''
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')
from storybuilder.builder.world import World


# scenes
def old_school_ghost(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("旧校舎の幽霊",
            w.cmd.change_stage("ClubRoom"),
            w.cmd.change_camera("kiri"),
            w.plot_note("$kiriが入っている文芸部が部室として使わせてもらっている空き教室は、旧校舎にあった"),
            w.plot_note("その旧校舎では最近幽霊が出ると噂になっている"),
            w.plot_note("$kiriは謎を解くのは得意だが不思議が大嫌いだった"),
            w.plot_note("誰かが勘違いしているだけで世界には不思議などないと豪語している"),
            w.plot_note("部室にやってくると鍵が開いていた"),
            w.plot_note("中には同級生で同じ部員の$yujiがいて、ノートを気まずそうに置いていた"),
            w.plot_note("$yujiは$kiriに同じ部員の$natsuのことを相談してくる"),
            w.plot_note("$yujiは$natsuのことが好きでこの部に入ったのだった"),
            w.plot_note("三年生がほぼ抜けた後で、現在は二年生の$kiriたち三人だけになってしまっている"),
            w.plot_note("$kiriは本を読んでいるだけでも何も言われないこの部が気に入っていた"),
            kiri.be("$Sは一人部室で文庫本を開いていた"),
            yuji.come("うるさい足音を立てながら$Sが入ってくる"),
            yuji.talk("おいおいおい、出たんだって！　マジでさ！"),
            kiri.talk("うるさいね", "本を読んでいる人間がいるのにそんなに大声を出すというのは不謹慎だよ"),
            yuji.do("傍までやってきて、机に座り"),
            yuji.talk("旧校舎の幽霊、マジで出たらしい",
                "一組の永瀬が言ってた",
                "なんでも誰もいないのにダダダって足音がして駆け抜けていったんだって"),
            "これはリスが住み着いている、という話",
            kiri.talk("えらく騒々しい幽霊だね", "そうやって大きな音を立てるのは西洋風だと思うんだが、旧校舎の幽霊というのは外国人なのかい？"),
            yuji.talk("知らないさ", "$meたちが高校に入る前からずっと七不思議なんだから"),
            kiri.talk("それでその七不思議というのはどれとどれとどれなんだい？",
                "どうせ答えられないだろう",
                "適当におもしろおかしく噂を立てて勝手に七不思議とかにするという姿勢を、$meはどうにも評価できないね"),
            yuji.talk("$kiri、お前ってほんとつまらないって言われない？"),
            kiri.talk("つまらないのは良いことじゃないか", "ガス管だって水道管だって詰まっていない方が正常だ"),
            yuji.do("苦笑しつつもカバンからこっそりノートを取り出し、それをテーブルに置いて離れる"),
            kiri.talk("ちゃんと書いてきたんだろうね？"),
            yuji.talk("な、何の話だ？"),
            kiri.talk("君が言い出したんだよ、リレー小説をやろうと",
                "最初の一月だけじゃないか、ちゃんと書いていたの"),
            yuji.talk("お前読んだのかよ"),
            kiri.talk("自分の前までの分は読む", "まがりなりにもリレー小説だからね",
                "続きでなくてもいいとはルールに記載してあるが、それでも続きということで頭を捻るのが大事だろう"),
            yuji.talk("別に何書いたっていいんだよ", "ただこれを通じてあいつと交流を深めることが目的なんだから"),
            natsu.come("そっと入ってきて"),
            natsu.talk("交流って何？"),
            yuji.talk("おい！　何だよ$natsu",
                "入ってくるときはノックしろって！"),
            natsu.talk("したけど聞こえなかったんでしょ？",
                "それより何の話？", "あ、それって新装版のアガサ・クリスティでしょ？"),
            kiri.talk("おはよう"),
            natsu.talk("もう四時よ", "こんにちは、$kiri"),
            kiri.talk("いや、いつもギリギリに滑り込んでくるか、五分程度は遅刻してくる$natsuが珍しいなと思って"),
            natsu.talk("$yujiが何書いてきたか気になって",
                "先週のは意外とトリックに騙されちゃったからさ",
                "ひょっとして$yujiって小説得意？"),
            yuji.talk("べ、別にそんなことないよ。たまたまだよ"),
            natsu.do("謙遜しなくていいよ、とか言いつつもおもむろにノートを手に取り、ぺらぺらとページを捲る$S"),
            natsu.talk("きゃっ！"),
            natsu.do("叫び声を上げてノートを床に落としてしまう"),
            yuji.talk("な、何だよ？"),
            natsu.talk("これ……見て"),
            kiri.do("二人とも手に取らないので拾ってみると、開いたページには赤い字でびっしりと何か書かれていた"),
            natsu.talk("ゆ、幽霊よ", "きっと旧校舎の幽霊が書いたのよ！", "$meたちのリレー小説の続きを！"),
            )


def find_ghost_novel(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("幽霊小説を見つけた",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("思い出したかのように$yujiにリレー小説のことを確認しようとすると、$natsuが入ってきた"),
            w.plot_note("$natsuは同級生で何かと不思議なことやオカルトが大好きな女子"),
            w.plot_note("現実派の$kiriとはいつも言い争いになっていた"),
            w.plot_note("「ねえ知ってる？」と$natsuのいつものが始まる"),
            w.plot_note("彼女が始めたのは旧校舎の幽霊部員の話だった"),
            w.plot_note("旧校舎では最近幽霊部員が出て、勝手に物を消したり、別の場所に移動させたり、落書きしてあったりと、好き放題しているらしい"),
            w.plot_note("だが$kiriは「幽霊なんていない」と断言する"),
            w.plot_note("分からない物事を幽霊やオカルト現象にして考えないのは人間の頭脳の敗北で、真実を知ろうとしない怠慢だと"),
            w.plot_note("$natsuはノートを見て、そこに奇妙な書き込みを見つける。赤字で正に幽霊が書いた小説だった"),
            "顧問の$tobeはほとんど顔を出さない",
            "$yujiには姉がいる",
            "$yujiは$natsuに惚れている",
            "リレー小説のルールがノート冒頭に書いてあるが、それについての注意書きというか、それを読む作業をどこかに",
            )


def a_ghost_novel(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("幽霊小説",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("幽霊が書いた小説はこんなものだった"),
            w.plot_note("それはまだ新校舎が建てられる前の、旧校舎が普通に校舎として使われていた時代"),
            w.plot_note("ある生徒が自殺した"),
            w.plot_note("原因はいじめだと言われているが、真相は誰も知らない"),
            w.plot_note("そのままその事件は忘れられ、新しい校舎が建ち、旧校舎は使われない空き教室になった"),
            w.plot_note("その旧校舎では夜な夜なピアノの音がしたり、誰かのうめき声がしたりして、幽霊が出ると噂になった"),
            w.plot_note("好奇心旺盛な生徒が本当に幽霊が出るかどうか調べようと、ある日、旧校舎に泊まり込みで番をする"),
            w.plot_note("しかし結局幽霊が出ることはなく、その生徒たちは朝を迎えた"),
            w.plot_note("だが翌日、学校では幽霊を見つけにいったその生徒たちが消えたと話題になっていた"),
            w.plot_note("それを確かめようと次々と生徒が旧校舎に入り、幽霊になってしまった"),
            w.plot_note("これはその幽霊の生徒の一人が書き残した記録である、という結び文になっている"),
            kiri.be(),
            kiri.explain("そこに赤字の右側に鋭く釣り上がった文字で書かれていた小説は、こんな内容だった"),
            kiri.explain("敷地の東側に新校舎が建てられて間もない頃の話",
                "旧校舎もしばらく教室や図書室などを授業で使われていた",
                "特に部活動をするのに空き教室が沢山できたので、雨後の筍のようにあれやこれやと沢山の部活、同好会が生まれた"),
            kiri.explain("しかしある時、生徒の一人が図書室に本を返しにやってくると、閉室時間にもかかわらず部屋に明かりが点いていたという",
                "彼女は中で司書か図書委員でも残っているのだろうと思ったが、",
                "声をかけてみても返事はない"),
            kiri.explain("仕方なく返却ポストに入れて、その日は帰ってしまった",
                "しかし翌日も、またその翌日も、閉室時刻を過ぎてから図書室に明かりが点いているので気になり、",
                "思い切って図書委員をしている生徒に尋ねたが、今は司書はおらず、担当の先生もそんな時間には図書室に行かないし、",
                "図書委員は自分一人だと言っていた"),
            kiri.explain("そこでその生徒は閉室時刻前に図書室に入り、閉室になるまでずっと本を広げて待機していた",
                "図書委員の子は鍵を掛けておいてと頼み、先に帰ってしまった"),
            kiri.explain("その翌日、図書室に一人残っていた生徒が姿を消してしまった",
                "事件性が疑われたが結局見つからず、それはやがて幽霊の仕業ということになった"),
            kiri.explain("今でも旧校舎の図書室に行くと閉室時刻を過ぎた夜に、ときどき明かりが灯っているのを見ることがあるらしい",
                "しかしその明かりを見た生徒には次々と不幸が襲いかかり、転校していったり、病気になったり、事故にあったりした"),
            kiri.explain("あまりに続くので以降、呪いの図書室として封鎖され、図書室は新校舎へと移設された"),
            kiri.explain("旧校舎には幽霊が住み着いている",
                "もし不審な明かりを見つけても疑問に思わないことだ",
                "それを覗こうとした生徒は幽霊に取り憑かれてしまうだろう"),
            )


def detective(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("$kiriの推理",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("$kiriはその小説を見て「幽霊なんていない」と断言する"),
            w.plot_note("誰がやったものだと言う$kiriに、$natsuは説明を求める"),
            w.plot_note("$kiriはまずこのリレー小説のノートの存在を知っているのが現在の部員三名と顧問の$tobeだけであると示す"),
            w.plot_note("それから一人一人に誰もこれを書いていないか確かめる"),
            w.plot_note("$natsuはいつも自分の前の分だけ確認し、そこから構想をねって金曜日の締切までに書いておいておいたと"),
            w.plot_note("それに対して$yujiは自分はそんなものを書いた覚えはない、とだけ言うが、いつもと違い雰囲気がおかしい"),
            w.plot_note("$natsuに詰められ、$yujiは実はリレー小説を書いてこなかったと告白する"),
            w.plot_note("$natsuと$yujiの口論が始まるが、それに割って入り、誰も書いていないという証言を確認する"),
            kiri.be(),
            natsu.be(),
            yuji.be(),
            kiri.do("三人はその小説を読み終えて、互いの顔を見る"),
            natsu.talk("これって、幽霊が自分がどうして生まれたか知ってほしくて書いたってこと？"),
            kiri.talk("普通に誰かが悪戯で書いたんだよ", "そもそも幽霊ってペンは握れるのか？",
                "ノートを開いたり、そこにこういうまとまった文章を書く技術は持っているのか？",
                "考えるための頭脳はあるのか？"),
            yuji.talk("またそうやって現実的な話をするし",
                "じゃあ誰がどうやって$meたちしか知らないノートに書いたっていうんだ？"),
            kiri.talk("何者かが赤いペンを使って、知らない間に書いた",
                "それ以外の可能性を検討する方が馬鹿馬鹿しいと思う"),
            kiri.do("$kiriは状況を簡単に説明する"),
            natsu.do("それに対して$Sは顔を明るくして、期待した"),
            )


def note_management(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("ノートの管理状況",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("次に$kiriはノートの保管状況についてまとめる"),
            w.plot_note("まずはノートの冒頭に書いてあるリレー小説についての注意書きを読み上げる"),
            w.plot_note("リレー小説はこの学校を舞台とすること"),
            w.plot_note("小説は前の人が書いた内容を使ってもいいし、使わずに新しい話を書いてもいい"),
            w.plot_note("見開き一ページ、最低でも書くこと"),
            w.plot_note("次の人はページをめくった次の見開きページを使うこと"),
            w.plot_note("リレー小説が始まったのは２学期になってからで、最初はみんなしっかり書いていた"),
            w.plot_note("しかし今月に入ってから$yujiは自分が小説を書いていないと告白した"),
            w.plot_note("ノートを確認すると、けれど$yujiの回には彼が書いた覚えのない小説が書かれている"),
            w.plot_note("その文字は$yujiの綺麗な字によく似ていた。ただ彼も書いたかどうか覚えてないと言う"),
            w.plot_note("それを発見したことで、最初は誰かが悪戯で赤字の小説を書き込んだ、というところから、本格的な幽霊小説事件になった"),
            w.plot_note("けれど$kiriはそれでも慌てることなく、新しい情報が手に入ったので、より幽霊の可能性は低くなったと言う"),
            w.plot_note("$kiriは誰が書いたかは置いておいて、次にノートがどう管理されていたかを話す"),
            w.plot_note("ノートは各自担当の週は自宅に持ち帰ったり、自由なようにしていた"),
            w.plot_note("その間は誰でも自由に書き込める可能性があるが、誰かに見せたりしたか尋ねたが、三人とも見せていないと話す"),
            kiri.talk(""),
            # TODO
            )


def clubroom_management(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("部室の管理状況",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("次に部室の管理について話す"),
            w.plot_note("鍵は顧問の$tobeが保管しているが、ほとんど顔を出さないので、部員の誰かが鍵を持っていることが多い"),
            w.plot_note("犯行が行われたと想定される土曜に$yujiがノートを部室に置いてから、月曜に$kiriが部室を開けるまでの間"),
            w.plot_note("そこで$yujiが実は小説を書かずにそのまま出したと告白したが、次の順番の$natsuは急遽用事があってその日は部室にノートを取りに来られなかった"),
            w.plot_note("以上のことから、誰でも犯行可能であり、また部員三人は誰もやっていないという証言から外部犯であると"),
            w.plot_note("$kiriはそれで現実の証明は終わったと言うが、$natsuは納得しない"),
            w.plot_note("しかし翌週、再び幽霊小説が書かれていた"),
            )


def ghost_novel_again(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("幽霊小説再び",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("再び書かれていた赤字の幽霊小説の内容は、まるで今の文芸部内の騒動を予見したものに見えた"),
            w.plot_note("$natsuは幽霊の仕業だと証明する為に部室に監視カメラを設置する"),
            w.plot_note("幽霊が監視カメラに映るかどうか気になる、と冗談なのか本気なのか分からない言葉で承諾した$kiri"),
            )


def surveillance_camera(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("監視カメラ",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("週明け、部員全員揃ってから$kiriたちは監視カメラ映像を確認した"),
            w.plot_note("監視カメラに映っていたのは日曜に構内清掃に入る掃除のおばちゃんだった"),
            w.plot_note("彼女はノートを手に取り、何かしている。結構な時間何かをしていて、それからノートを元の場所に戻した"),
            )


def interview_hatake(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("$hatakeの尋問",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("$natsuは自分のコネを利用して、その清掃員を突き止め、呼び出すことに成功する"),
            w.plot_note("清掃員の$hatakeを呼び出して、$kiriは監視カメラの映像を見せて、そこで何をしていたのか尋ねた"),
            w.plot_note("彼女は学校の$OGで元文芸部員だったが興味本位でノートを覗いたことはあっても、続きを書いたりはしていないと告白する"),
            w.plot_note("$natsuはそれでも監視カメラ映像から$hatakeが幽霊騒動の原因だった説を押す"),
            w.plot_note("$kiriは$natsuに字を書かせる。左利きだと監視カメラ映像から分かっていて、更にその字の傾きが特徴的だった"),
            w.plot_note("$hatakeの犯行説は否定されたが、彼女は自分がこのノートに気づいたのは顧問の$tobeが持ち出しているのを見たからだと証言する"),
            w.plot_note("その日は運悪く、$tobeは別の用事で学校におらず、確認することはできなかった"),
            w.plot_note("$kiriはもうこれ以上書かれることはないから安心していいと言う"),
            w.plot_note("その通りで、次の週明けには幽霊小説はなかった"),
            )


def testimony_tobe(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    return w.scene("$tobeの証言",
            w.cmd.change_stage("ClubRoom"),
            w.plot_note("その週末は$tobeに部室の鍵を預けていたので、$kiriは$tobeを連れ立って部室へとやってきた"),
            w.plot_note("部室に入ると、$tobeにノートのリレー小説に続きを書いたかどうか尋ねるが、$tobeはそんなことはしないと断言する"),
            w.plot_note("$kiriは$tobeに$natsuによって幽霊がリレー小説の続きを書いたとでっちあげられていると説明"),
            w.plot_note("だがノートを確認するとしっかり小説の続きが書かれている"),
            w.plot_note("ただし内容は繋がっていない"),
            w.plot_note("それを見て$kiriは犯人が分かったと言う"),
            )


def truth(w: World):
    kiri, natsu, yuji = w.get('kiri'), w.get('natsu'), w.get('yuji')
    shiki = w.get('shiki')
    tobe = w.get('tobe')
    return w.scene("事件の真相",
            w.plot_note("部員たちが揃うと$kiriはこの茶番を終わらせると宣言し、今回の事件について説明を始める"),
            w.plot_note("発端は$yujiがリレー小説をやりたいと言い出したことだった"),
            w.plot_note("それを思いついたのは$yujiではないだろう、と尋ねると、彼の姉$shikiが考えついたものだった"),
            w.plot_note("そうなった事情は伏せた（$yujiが$natsuともっと話す手段がないかとか尋ねたのだろう）が、今回の話を知っていたのは部員と顧問、清掃員を除くと、$yujiの姉$shikiもいたことになる"),
            w.plot_note("それに加えて、最初こそ何とか相手の気を引こうと小説を書いていた$yujiが書くのが面倒になり、書かなくなった"),
            w.plot_note("途中から$shikiが完全に$yujiの代わりを務めていたが$yujiはそれを知らず、書かなくても大丈夫なんだと思ってノートだけ持って帰るようになっていた"),
            w.plot_note("「でもそれなら文字を見て気づくんじゃない？」と$natsuがつっこむ"),
            w.plot_note("そこで$yujiに字を書かせる。性格に比べてやけに綺麗な字を書く。それは小さい頃から習字を習わされて、字だけは綺麗に書けたからだ"),
            w.plot_note("ぱっと見では見分けがつかない"),
            w.plot_note("ではなぜ$natsuがそれを「幽霊が書いた」と勘違いしたのか"),
            w.plot_note("赤字で、しかもホラー系のフォントを印字したものだったからだ。人間が書いたみたいな文字だが、造られたフォントだと説明する"),
            w.plot_note("$kiriは$yujiに頼んで$shikiに連絡を取ってもらう"),
            w.plot_note("連絡がつくと、$kiriに変わるように言われ、電話に出た"),
            w.plot_note("$shikiは$kiriに、あの幽霊小説がいつ書かれたものなのか、尋ねる"),
            w.plot_note("$kiriはそれがこのリレー小説を提案した時には既に作られていたことを指摘し、最初から書かれていたと言う"),
            w.plot_note("なぜ気づかなかったのか、$natsuは疑問を持つが、それに対して、最初の小説だけが書かれていたことを告げる"),
            w.plot_note("また巧妙にページが切られていることも"),
            w.plot_note("そこまで初日に知っていて何故指摘しなかったのか？　という$shikiの問いに「ちゃんと外部犯だと示した」と。それでＱＥＤのつもりだったと"),
            w.plot_note("謎は相手に分かるように説明しないといけないと$shikiは主張する"),
            w.plot_note("謎を解いていた$kiriのことを$shikiは気に入り、大学のミステリ研に来るよう要請するが、不思議を作る側は嫌いだと断った"),
            w.plot_note("そうなった事情は伏せた（$yujiが$natsuともっと話す手段がないかとか尋ねたのだろう）が、今回の話を知っていたのは部員と顧問、清掃員を除くと、$yujiの姉$shikiもいたことになる"),
            w.cmd.change_stage("ClubRoom"),
            natsu.come("部屋に入ってくる$S"),
            yuji.come("続いて$Sも入ってくる"),
            tobe.be("部室で待っている$S"),
            natsu.talk("事件解決したってホント？"),
            yuji.talk("幽霊見つかったってほんとか？"),
            tobe.talk("なんだよ、事件とか幽霊とか", "そういう話なのか？　$kiri"),
            kiri.do("部員が揃ったのを見て$Sは「茶番を終わらせよう」と宣言し、事件についてのあらましを話し始める"),
            kiri.talk("これは別に最初から事件でも幽霊の仕業でもなかったんですよ", "単なる勘違いです",
                "いや、そうなるべく仕向けたといった方が正しいでしょう"),
            natsu.do("きょとんとした表情の$S"),
            kiri.talk("まず思い出してもらいたいんだ",
                "このリレー小説をやろうと言い出したのが誰だったのかを"),
            natsu.do("互いの顔を見合わせる"),
            yuji.talk("で、誰だよ？"),
            kiri.talk("お前だよ、$yuji"),
            yuji.talk("え？　$me？"),
            yuji.do("全然記憶になさそう"),
            kiri.talk("普通ならそんなこと思いつかないだろうな",
                "そもそも発案者の癖に一ヶ月しか続けられなかったんだ", "最初からリレー小説が書きたかった訳じゃない"),
            natsu.talk("他に目的があったってこと？"),
            kiri.talk("それについては本題と関係ないから今は置いておく",
                "ともかく$meたちは$yujiが言い出したことで文芸部の活動の一つとしてリレー小説を始めた",
                "その時には確か先生もいましたよね"),
            tobe.talk("ああ", "部費でノート購入するって話があった"),
            kiri.talk("そのノート、先生が購入したんですか？"),
            tobe.talk("いや、あれは$ln_yujiが買ってきて領収書と引き換えに代金を渡したぞ"),
            kiri.talk("どうしてあのノートを？　普通の大学ノートでは駄目だったのか？"),
            yuji.talk("どうせならオシャレな奴がいいだろうって、その"),
            kiri.talk("まあいいか",
                "ともかくノートは$yujiが準備した",
                "そのノートの冒頭にはこんな文言がわざわざ書いてある"),
            kiri.do("リレー小説の注意点を読み上げる"),
            kiri.talk("つまりこれは噛み砕いていえば、それぞれに割当ページが最初から決められているということだ",
                "たとえば最初は言い出しっぺの$yujiが２ページと３ページを使う",
                "次の$natsuは４ページと５ページ、という風に"),
            natsu.talk("見開きの方が分かりやすいと思ったから？"),
            kiri.talk("リレー小説なんてそのまま続きに書いたっておかしくないのに、なぜわざわざ指定してあったのか",
                "それが疑問点その一だ"),
            yuji.talk("他にもあるのか？"),
            kiri.talk("幽霊小説は誰が書いたにしても、なぜわざわざ赤字を使ったのか？"),
            natsu.talk("その方が幽霊っぽい……"),
            kiri.talk("それもあるが、発見してもらいやすくする為だ",
                "先生が、実は第一発見者だったんだ"),
            tobe.talk("ああ", "一応顧問としてお前らがどんなもん書いてるのかなと思ってぺらぺらめくっていったら、赤字でこれは幽霊の書いたものだとかあったから"),
            kiri.talk("その時はこんなにしっかり書いてありましたか？"),
            tobe.talk("いや、ちょうどこの部分だよ",
                "旧校舎には幽霊がいる", "ここだけだね"),
            kiri.talk("先生の証言が正しいなら、残りの部分は後日書き足されたことになる",
                "先生がそれを確認したのは？"),
            tobe.talk("二週目の金曜かな"),
            kiri.talk("ちょうど一巡したときだ",
                    "最後に$meが書いて、ここに仕舞っておいた"),
            natsu.talk("どういうことなの？"),
            kiri.talk("これが疑問その二だ",
                    "そして最後の疑問", "これが最も重要な問いになるんだけど、",
                    "$yujiたちは自分が書く次のページを見なかったのか？"),
            natsu.talk("見てないわよ"),
            yuji.talk("そもそもそんなこと考えてる余裕なんかなくて"),
            kiri.talk("先に書いてたら悪いと思って$meは見なかった。初日を除いて"),
            natsu.talk("え？　それってつまり"),
            kiri.talk("いや", "$meが見たときには既に書かれていた",
                    "インクの乾き具合からしてノートを購入して間もなく書かれたものだ",
                    "$yujiに尋ねる",
                    "このノートを購入して君に渡したのは誰だ？", "その人物が今回のことを仕組んだ犯人だ",
                    "そしてこの幽霊騒動の原因を作った犯人でもある"),
            kiri.do("場の空気が静まる"),
            natsu.talk("$yuji？"),
            yuji.talk("いや、違うんだ",
                    "$meはただ言われた通りにやっただけで……"),
            natsu.talk("だから誰によ？"),
            yuji.do("ばつが悪そうな$Sは$kiriに助けを求めてくる"),
            kiri.talk("$yujiには大学生のお姉さんがいる",
                    "彼女はこの高校の$OGであり、更にいえばこの文芸部を作った存在ですね、先生"),
            tobe.talk("ああ、よく調べたな"),
            kiri.talk("文化祭に出していた文集の号数の一番に、ちゃんと部長として書いてありましたから、そうじゃないかなと思ったんです"),
            tobe.talk("$full_shikiは頭も顔も良かったが、どうにも変わり者でな",
                    "どこかに所属しなければいけないという校則そのものに意義を唱えていたんだが、さすがに一生徒の意見で校則までは変えられずに、",
                    "仕方なくこの部を作ったんだ"),
            kiri.talk("これで分かっただろう？"),
            kiri.do("みんなの顔を見回して、こう切り出す"),
            kiri.talk("今回の首謀者は$full_shiki、$yujiの姉だ"),
            natsu.do("納得できない表情の$S"),
            natsu.talk("なんでそうなるの？", "どうしてそんなことしなくちゃいけないのよ？", "$yuji、なんか聞いてるの？"),
            yuji.talk("いや、$meは全然知らない"),
            yuji.explain("$yujiはその経緯を話し始める"),
            yuji.talk("$meさ、せっかく$natsuと一緒の部になったから、もっとこう、コミュニケーション取れる方法ないかなって思ってて",
                    "それをさ、姉貴にもらしちまったら、今回のリレー小説のこと提案されたんだ",
                    "自分たちのときもやってたから、いいんじゃないかって"),
            kiri.talk("つまり提案したのは$yujiの姉だったということ",
                    "ちなみに部の活動日誌からは今までにリレー小説をしていたという痕跡は見つけられなかった",
                    "これは彼の姉が嘘をついているか勘違いをしていたということになる"),
            natsu.talk("そんな勘違いをするようなタイプなの？"),
            yuji.talk("全然", "逆に一月前の晩飯の内容まで覚えてるくらい細かいところまでよく記憶してる",
                    "幼稚園時代にカブトムシとゴキブリを同じ生き物だと思ってて、虫かごにゴキブリ集めてたことを未だに言われるからな"),
            natsu.talk("流石にそれは忘れないと思う"),
            natsu.do("気持ち悪そうな顔をして一歩引く"),
            kiri.talk("それじゃあ提案者は分かった",
                    "ノートを買って渡したのもお姉さんだろう？",
                    "なら彼女にとっては細工をするのは簡単だった訳だ"),
            natsu.talk("でも、何故そんなことを？", "悪戯したかっただけ？"),
            kiri.talk("それは今から確かめる", "ちょっといいか"),
            kiri.do("$yujiのスマホを借りて姉に連絡する",
                    "すぐに$lineが帰ってきた"),
            shiki.voice("はじめまして、$kiri君",
                    "あなたが連絡してくるのは分かっていたわ", "ただ、ちょっと遅かったわね", "ヒントを使わなかったの？"),
            kiri.talk("犯人が部員の中にいないことは分かっていました", "ただその外部犯が$yujiのお姉さんだという可能性に絞るのに時間がかかりました"),
            shiki.voice("$yujiから何も聞いてなかったのね？　それで$meにたどり着いたのは驚きだわ",
                    "$yuji、あんたちゃんと彼に言わなかったの？",
                    "リレー小説の発案者が$meだってこと"),
            yuji.talk("$meが考えたことにしちゃったからさ、今更それが嘘だって言い出せなくて"),
            shiki.voice("じゃあホントに$yujiが考えたことをスタートにして推理しちゃったの？　なかなかやるわね"),
            kiri.talk("一つ質問してもいいですか？"),
            shiki.voice("どうぞ"),
            kiri.talk("旧校舎に幽霊が出るという噂を流したのはあなたですね？"),
            shiki.voice("理由は？"),
            kiri.talk("空き教室を部室として確保するため",
                    "部室が準備できなければ部が認められなかったから、です"),
            shiki.voice("驚いた", "そうよ", "どうして分かったの？"),
            kiri.talk("あなたが書き加えた幽霊小説のネタが、一番最初に噂になった話そのものだったからです"),
            shiki.voice("でもそれは最初の噂を知っている誰でもが真似ることが可能じゃない？"),
            kiri.talk("卒業生であれば、そうですね", "けれど現在この旧校舎の幽霊の話は全然違っているんですよ",
                    "実はあなたが卒業した翌年、この高校で自殺者が出ました",
                    "その事件が新しい幽霊話として上書きされてしまったんです"),
            shiki.voice("ああ、そういえばそんなことがあったわね", "そう"),
            kiri.talk("一度生まれたこの手の噂は形を変えてずっと生存し続けます",
                    "だから$meは幽霊もオカルトも嫌いなんです"),
            shiki.voice("気分を害したなら謝るわ", "ただ$yujiからあなたのことを聞いて、少し試してみたくなったの",
                    "今の発言でますます気になる存在になったわ",
                    "ぜひ今度うちの大学のミステリ研にいらっしゃい",
                    "歓迎するわ"),
            kiri.talk("それは遠慮しておきます", "この世界に不思議を生み出す連中のことを、将来的に好きになれそうにありませんから"),
            kiri.do("電話を切る"),
            kiri.talk("以上で全て解決しただろう？"),
            natsu.do("きょとんとしている"),
            kiri.do("本を読み始める$S"),
            tobe.talk("あー、えっと、それで何だったんだ？"),
            yuji.talk("$meが悪かったよ", "もうこんな幽霊小説はなしだ"),
            yuji.do("ページをちぎりとると、表紙を『連絡帳』と書き換えた"),
            natsu.talk("で、今度は何を書くの？"),
            yuji.talk("読んだ漫画の感想でも書くよ"),
            natsu.do("$Sに苦笑される"),
            kiri.do("一人黙々と読書を続ける$Sだった"),
            )

